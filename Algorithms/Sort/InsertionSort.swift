//
//  InsertionSort.swift
//  Algorithms
//
//  Created by xiong_jia on 2022/11/15.
//

import Foundation

// MARK: æ’å…¥æ’åº
// ç±»ä¼¼äºæ•´ç†æ’åºï¼Œå°†ä¸€å¼ ç‰Œæ’å…¥åˆ°å·²ç»æ’åºå¥½çš„æ•°ç»„å½“ä¸­
// åœ¨è®¡ç®—æœºçš„å®ç°ä¸­ï¼Œä¸ºäº†ç»™è¦æ’å…¥çš„å…ƒç´ è…¾ç©ºé—´ï¼Œéœ€è¦å°†åé¢çš„å…ƒç´ å‘å³ğŸ‘‰ç§»åŠ¨ä¸€ä½
class Insertion<Item: Comparable> {
    func sort(_ array: inout [Item]) {
        for i in 1..<array.count {
            for j in (1...i).reversed() {
                if less(array[j-1], to: array[j]) { break }
                exch(&array, j-1, with: j)
            }
        }
    }
    
    // å¦‚æœæƒ³è¦å¤§å¹…æå‡æ’å…¥æ’åºçš„é€Ÿåº¦ï¼Œåªéœ€è¦åœ¨å†…å¾ªç¯ä¸­å°†è¾ƒå¤§çš„å…ƒç´ å‘å³ğŸ‘‰ç§»åŠ¨è€Œä¸æ˜¯æ€»æ˜¯äº¤æ¢ä¸¤ä¸ªå…ƒç´ ã€‚ï¼ˆè¿™æ ·èƒ½è®©è®¿é—®æ•°ç»„çš„æ¬¡æ•°å‡åŠï¼‰
    func sortOptimize(_ array: inout [Item]) {
        for i in 1..<array.count {
            let temp = array[i]
            for j in (1...i).reversed() {
                if less(array[j-1], to: array[j]) {
                    array[j] = temp
                    break
                }
                array[j] = array[j-1]
            }
        }
    }
}
// å¯¹äºé•¿åº¦ä¸º N ä¸”ä¸»é”®ä¸é‡å¤çš„æ•°ç»„ï¼Œå¹³å‡æƒ…å†µä¸‹æ’å…¥æ’åºéœ€è¦ ï½N^2/4 æ¬¡æ¯”è¾ƒä»¥åŠ ï½N^2/4 æ¬¡äº¤æ¢ã€‚
// æœ€åçš„æƒ…å†µéœ€è¦ ï½N^2/2 æ¬¡æ¯”è¾ƒä»¥åŠ ~N^2/2 æ¬¡äº¤æ¢
// æœ€å¥½çš„æƒ…å†µéœ€è¦ N-1 æ¬¡æ¯”è¾ƒä»¥åŠ 0 æ¬¡äº¤æ¢

// å¯¹äºéƒ¨åˆ†æœ‰åºæ•°ç»„ï¼ˆæ•°ç»„ä¸­å€’ç½®çš„æ•°é‡å°äºæ•°ç»„å¤§å°çš„æŸä¸ªå€æ•°ï¼Œé‚£ä¹ˆç§°è¿™ä¸ªæ•°ç»„æ˜¯éƒ¨åˆ†æœ‰åºçš„ï¼‰ï¼Œä¸‹é¢æ˜¯å‡ ç§å…¸å‹çš„éƒ¨åˆ†æœ‰åºæ•°ç»„
// 1. æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ç¦»å®ƒæœ€ç»ˆä½ç½®ä¸è¿œ
// 2. ä¸€ä¸ªæœ‰åºå¤§æ•°ç»„æ¥ä¸€ä¸ªå°æ•°ç»„
// 3. æ•°ç»„ä¸­åªæœ‰å‡ ä¸ªå…ƒç´ ä½ç½®ä¸æ­£ç¡®
// æ’å…¥æ’åºå¯¹è¿™æ ·çš„æ•°ç»„å¾ˆæœ‰æ•ˆï¼Œå½“å€’ç½®çš„æ•°é‡å¾ˆå°‘æ—¶ï¼Œæ’å…¥æ’åºå¯èƒ½æ¯”å…¶ä»–æ’åºç®—æ³•å¿«ã€‚

// æ’å…¥æ’åºéœ€è¦äº¤æ¢çš„æ“ä½œå’Œæ•°ç»„ä¸­å€’ç½®çš„æ•°é‡ç›¸åŒï¼Œéœ€è¦çš„æ¯”è¾ƒæ¬¡æ•°å¤§äºç­‰äºå€’ç½®çš„æ•°é‡ï¼Œå°äºç­‰äºå€’ç½®çš„æ•°é‡åŠ ä¸Šæ•°ç»„çš„å¤§å°å‡ 1

// æ¨¡ç‰ˆæ–¹æ³•
extension Insertion {
    /// äº¤æ¢å…ƒç´  v å’Œå…ƒç´  w çš„ä½ç½®
    /// - Parameters:
    ///   - v: å…ƒç´  v åœ¨æ•°ç»„ä¸­çš„ index
    ///   - w: å…ƒç´  w åœ¨æ•°ç»„ä¸­çš„ index
    private func exch(_ array: inout [Item], _ v: Int, with w: Int) {
        let temp = array[v]
        array[v] = array[w]
        array[w] = temp
    }
    
    /// åˆ¤æ–­å…ƒç´  v æ˜¯å¦å°äºå…ƒç´  w
    /// - Parameters:
    /// - Returns: if v < w, return true
    private func less(_ v: Item, to w: Item) -> Bool {
        return v < w
    }
    
    /// åˆ¤æ–­æ•°ç»„å…ƒç´ æ˜¯å¦æœ‰åº
    func isSorted(_ array: [Item]) -> Bool {
        for index in 1..<array.count {
            if !less(array[index-1], to: array[index]) { return false }
        }
        return true
    }
}
